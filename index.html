<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<meta name="description" content="">
		<meta name="author" content="">

		<title>Grid Template for Bootstrap</title>

		<!-- Bootstrap core CSS -->
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">

		<!-- Custom styles for this template -->
		<link href="css/estilos.css" rel="stylesheet">
	</head>

	<body>
		<div class="container">

			<div class="row mt-3 text-center">
					<div class="col-md-12">
						 <input type="text" class="p-2" name="nickname" id="nickname" placeholder="NickName">
						 <button type="button" class="btn btn-dark btn-lg ml-3 px-5" onclick="guardar()">Jugar!</button>
					</div>
			</div>

			<div class="text-center mt-4">
				<div class="row">
					<div class="col-md-3"></div>
					<div class="col-md-2 borde_red esquina_redonda_izq" onclick="mostrarFicha_negra('a1')">
						<div id="a1" class="mt-4 p-5"></div>
					</div>
					<div class="col-md-2 borde_red" onclick="mostrarFicha_negra('a2')">
						<div id="a2" class="mt-4 p-5"></div>
					</div>
					<div class="col-md-2 borde_red esquina_redonda_der" onclick="mostrarFicha_negra('a3')">
						<div id="a3" class="mt-4 p-5"></div>
					</div>
					<div class="col-md-3"></div>
				</div>

				<div class="row">
					<div class="col-md-3"></div>
					<div class="col-md-2 borde_red" onclick="mostrarFicha_negra('b1')">
						<div id="b1" class="mt-4 p-5"></div>
					</div>
					<div class="col-md-2 borde_red" onclick="mostrarFicha_negra('b2')">
						<div id="b2" class="mt-4 p-5"></div>
					</div>
					<div class="col-md-2 borde_red" onclick="mostrarFicha_negra('b3')">
						<div id="b3" class="mt-4 p-5"></div>
					</div>
					<div class="col-md-3"></div>
				</div>

				<div class="row">
					<div class="col-md-3"></div>
					<div class="col-md-2 borde_red esquina_red_abajo_izq" onclick="mostrarFicha_negra('c1')">
						<div id="c1" class="mt-4 p-5"></div>
					</div>
					<div class="col-md-2 borde_red" onclick="mostrarFicha_negra('c2')">
						<div id="c2" class="mt-4 p-5"></div>
					</div>
					<div class="col-md-2 borde_red esquina_red_abajo_der" onclick="mostrarFicha_negra('c3')">
						<div id="c3" class="mt-4 p-5"></div>
					</div>
					<div class="col-md-3"></div>
				</div>				
			</div>

		</div> <!-- /container -->

		<!-- Bootstrap core JavaScript
		================================================== -->
		<!-- Placed at the end of the document so the pages load faster -->
		<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
		<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" integrity="sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF" crossorigin="anonymous"></script>

		

		<script type="text/javascript">

			var casillas = ['a1', 'a2', 'a3', 'b1', 'b2', 'b3', 'c1', 'c2', 'c3'];
			var jugadas_negras = [];
			var jugadas_rojas = [];
			var turno = true;
			var ganador_negras = false;
			var ganador_rojas = false;


			function guardar(argument) {
				localStorage.setItem('Nickname', $("#nickname").val());
				let str = localStorage.getItem('Nickname');
				console.log(str);
			}



			function mostrarFicha_roja(idColocada) {

				casillas.splice(casillas.indexOf(idColocada), 1);
				console.log(casillas);
				var nueva_casilla = casillas[Math.floor(Math.random() * casillas.length)];
				console.log(nueva_casilla);
		    setTimeout(function() { 
						$("#"+nueva_casilla).css({"background-image": "url('img/ficha_roja.png')", 
													 "background-repeat": "no-repeat",
													 "background-size": "95%",
													 "background-position": "center",
													 "height": "75%"
													}); 
		    }, 1000);

		    casillas.splice(casillas.indexOf(nueva_casilla), 1);
		    turno = false;
				
				if (ganador_negras) {
					alert('ganamos');
					return false;
				}else{

		    	verifica3enraya('R', nueva_casilla);
				}
		    

			}



			function mostrarFicha_negra(id) {

				if ( turno ) {

								$("#"+id).css({"background-image": "url('img/ficha_negra.png')", 
															 "background-repeat": "no-repeat",
															 "background-size": "95%",
															 "background-position": "center",
															 "height": "75%"
															}); 
								
							esperarTurno();
							verifica3enraya('N', id);
							mostrarFicha_roja(id);



				}else{
					alert("Por favor, espere 2 segundos a que sea su turno");
				}



			}


			function esperarTurno() {
					// if (turno) {
					// 		return turno;
					// }

			    setTimeout(function() { 
			     turno = true;
			     return turno;
			    }, 2000);
			}

			function verifica3enraya(equipo, id) {

				if(equipo=='N'){
					jugadas_negras.push(id);
				}else if (equipo=='R') {
					jugadas_rojas.push(id);
				}

				console.log("jugadas negras: " + jugadas_negras);
				console.log("jugadas rojas: " + jugadas_rojas);

				// console.log(jugadas_negras.indexOf('c1'));
				// console.log(jugadas_negras.includes('a1'));

				if(jugadas_negras.includes('a1') && jugadas_negras.includes('a2') && jugadas_negras.includes('a3')){
						
						// console.log('3 EN RAYA NEGRAS');
						// alert('3 EN RAYA NEGRAS');
						ganador_negras = true;


				}else if(jugadas_rojas.includes('a1') && jugadas_rojas.includes('a2') && jugadas_rojas.includes('a3')){
					// console.log('3 EN RAYA NEGRAS');
					// alert('3 EN RAYA NEGRAS');
					ganador_rojas = true;

				}else if(jugadas_negras.includes('b1') && jugadas_negras.includes('b2') && jugadas_negras.includes('b3')){
					console.log('3 EN RAYA NEGRAS');
					alert('3 EN RAYA NEGRAS');
					ganador_negras = true;
				}
		
			}

			// function buscarJugadaGanadora() {
			// 	// jugadas.
			// }


		</script>
	</body>
</html>